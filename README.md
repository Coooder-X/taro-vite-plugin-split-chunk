# vite-plugin-split-chunk

ä¸€ä¸ªä¸“ä¸º Taro 4.x å°ç¨‹åºé¡¹ç›®è®¾è®¡çš„ Vite æ’ä»¶ï¼Œç”¨äºæ™ºèƒ½åˆ†åŒ…å’Œä»£ç åˆ†å‰²ä¼˜åŒ–ã€‚è¯¥æ’ä»¶èƒ½å¤Ÿæ ¹æ®å°ç¨‹åºçš„åˆ†åŒ…é…ç½®è‡ªåŠ¨å°†ä»£ç åˆ†å‰²åˆ°å¯¹åº”çš„å­åŒ…ä¸­ï¼Œä¼˜åŒ–å°ç¨‹åºçš„åŠ è½½æ€§èƒ½ã€‚

[å®ç°æ€è·¯](./DOC.md)

## ç‰¹æ€§

- âš¡ æ”¯æŒ Taro 4.x çš„ vite é¡¹ç›®
- ğŸš€ **æ™ºèƒ½åˆ†åŒ…**: æ ¹æ® Taro é¡¹ç›®ä¸­ `app.config.ts` çš„é…ç½®è‡ªåŠ¨åˆ†æåˆ†åŒ…ç»“æ„
- ğŸ“¦ **ä»£ç åˆ†å‰²**: å°†ä»…è¢«å­åŒ…ä½¿ç”¨çš„ä»£ç è‡ªåŠ¨åˆ†å‰²åˆ°å¯¹åº”å­åŒ…ç›®å½•ã€‚å°½å¯èƒ½å°‘çš„ä»£ç å†—ä½™ï¼Œå°½å¯èƒ½å¤šåœ°ä¼˜åŒ–ä¸»åŒ…åŠåˆ†åŒ…çš„å¤§å°ã€‚
- ğŸ› ï¸ **å¼€å‘å‹å¥½**: æ”¯æŒå¼€å‘ç¯å¢ƒä¸‹çš„ Source Map ç”Ÿæˆ

## å®‰è£…

```bash
npm install vite-plugin-split-chunk --save-dev
```

æˆ–è€…ä½¿ç”¨ yarn:

```bash
yarn add vite-plugin-split-chunk --dev
```

## ä½¿ç”¨æ–¹æ³•

åœ¨ä½ çš„å°ç¨‹åºé…ç½®æ–‡ä»¶ä¸­æ·»åŠ æ’ä»¶ï¼š

```javascript
// config/index.ts
import { defineConfig } from 'vite'
import viteSplitChunkPlugin from 'vite-plugin-split-chunk'
export default defineConfig<'vite'>(async (merge) => {
  ...,
  compiler: {
    type: 'vite',
    vitePlugins: [
      viteSplitChunkPlugin({
        // ä¼ å…¥ app.config.ts çš„ç»å¯¹è·¯å¾„
        appConfigPath: join(__dirname, '../src/app.config.ts'),
      }),
    ],
  },
  ...
});
```

## é…ç½®é€‰é¡¹

### ViteSplitChunkPluginProps

| å‚æ•° | ç±»å‹ | å¿…å¡« | æè¿° |
|------|------|------|------|
| `appConfigPath` | `string` | âœ… | Taro é¡¹ç›®çš„ app.config.ts æ–‡ä»¶ç»å¯¹è·¯å¾„ |
| `isDebug` | `boolean` | âŒ | æ˜¯å¦å¼€å¯è°ƒè¯•æ¨¡å¼ï¼Œå¼€å¯åæ§åˆ¶å°å°†è¾“å‡ºæ›´å¤šä¿¡æ¯ï¼›åŒæ—¶ chunk æ–‡ä»¶åä½¿ç”¨é¡µé¢ id çš„æ‹¼æ¥ï¼Œæ–¹ä¾¿è§‚å¯Ÿ chunk ä¾èµ–å…³ç³» |

### é¡¹ç›®ç»“æ„

é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š
```
â”œâ”€â”€ demo
|  â”œâ”€â”€ react-mini
|  â””â”€â”€ vue-mini
â”œâ”€â”€ dist
|  â”œâ”€â”€ index.js
|  â”œâ”€â”€ types
|  â””â”€â”€ utils
â”œâ”€â”€ README.md
â”œâ”€â”€ src
|  â”œâ”€â”€ index.ts
|  â”œâ”€â”€ types
|  â””â”€â”€ utils
â””â”€â”€ types
```
src ç›®å½•ä¸‹æ˜¯æ’ä»¶æºç ã€‚åœ¨æ ¹ç›®å½•ä¸‹è¿è¡Œ `npm run build` åå¯è¾“å‡ºåˆ° dist ç›®å½•ï¼Œdemo ç›®å½•ä¸‹çš„ä¸¤ä¸ªç¤ºä¾‹é¡¹ç›®ä¾èµ– dist ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œä¾¿äºè°ƒè¯•æ’ä»¶ã€‚

## demo é¡¹ç›®

é¡¹ç›®ä¸­åŒ…å«äº†ä¸¤ä¸ªå®Œæ•´çš„ç¤ºä¾‹é¡¹ç›®ï¼Œåˆ†åˆ«åŸºäº react å’Œ vueï¼Œä½äº `demo/react-mini` å’Œ `demo/vue-mini` ç›®å½•ä¸‹ã€‚
ä½ å¯ä»¥å‚è€ƒè¿™ä¸ªç¤ºä¾‹æ¥äº†è§£å¦‚ä½•åœ¨å®é™…é¡¹ç›®ä¸­ä½¿ç”¨è¯¥æ’ä»¶,ä»¥åŠéªŒè¯å’Œå¯¹æ¯”åˆ†åŒ…çš„æ•ˆæœã€‚

### è¿è¡Œç¤ºä¾‹

#### æ„å»ºæ’ä»¶

åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹è¿è¡Œ `npm run build` å¯ä»¥æ„å»ºæ’ä»¶ï¼Œæ„å»ºåçš„æ–‡ä»¶ä¼šè¾“å‡ºåˆ° `dist` ç›®å½•ã€‚

```bash
# æ„å»ºæ’ä»¶
npm run build

# å¼€å‘æ¨¡å¼
npm run dev
```

#### è¿è¡Œ demo é¡¹ç›®

```bash
cd demo/react-mini
npm install
npm run build:weapp
```

> vue é¡¹ç›®åŒç†ã€‚


## å…¼å®¹æ€§

- âœ… Taro 4.x
- âœ… Vite 3.x+
- âœ… ç›®å‰ä»…åœ¨å¾®ä¿¡å°ç¨‹åºä¸­éªŒè¯å¯ç”¨ï¼Œå…¶ä»–å¹³å°å¾…éªŒè¯


## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## è®¸å¯è¯

MIT License

## æ›´æ–°æ—¥å¿—

### v1.0.0
- ğŸ‰ åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- âœ¨ æ”¯æŒåŸºäº Taro vite çš„æ™ºèƒ½åˆ†åŒ…
